{"ast":null,"code":"import _regeneratorRuntime from \"/Users/jeong-go-eun/Desktop/metagate/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jeong-go-eun/Desktop/metagate/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport web3 from './ethereum/web3';\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n/**\n * Convert UNIX timestamp to readable\n * @param {*} timestamp UNIX\n */\n\nfunction timeConverter(timestamp) {\n  var a = new Date(timestamp * 1000);\n  var month = months[a.getMonth()];\n  return a.getFullYear() + ' / ' + month + ' / ' + a.getDate();\n}\n\nfunction convertHexToString(input) {\n  var hex = input.toString();\n  var str = '';\n\n  for (var i = 0; i < hex.length && hex.substr(i, 2) !== '00'; i += 2) {\n    str += String.fromCharCode(parseInt(hex.substr(i, 2), 16));\n  }\n\n  return str;\n}\n\nfunction sleep(ms) {\n  return new Promise(function (resolve) {\n    return setTimeout(resolve, ms);\n  });\n}\n\nfunction asyncForEach(_x, _x2) {\n  return _asyncForEach.apply(this, arguments);\n}\n\nfunction _asyncForEach() {\n  _asyncForEach = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(array, callback) {\n    var index;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            index = 0;\n\n          case 1:\n            if (!(index < array.length)) {\n              _context.next = 7;\n              break;\n            }\n\n            _context.next = 4;\n            return callback(array[index], index, array);\n\n          case 4:\n            index++;\n            _context.next = 1;\n            break;\n\n          case 7:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, this);\n  }));\n  return _asyncForEach.apply(this, arguments);\n}\n\nfunction refine(m) {\n  if (!m) return null;\n  Object.keys(m).forEach(function (key) {\n    if (!isNaN(key)) return delete m[key];\n\n    switch (key) {\n      case 'title':\n        m[key] = convertHexToString(m[key]);\n        break;\n\n      case 'explanation':\n        m[key] = convertHexToString(m[key]);\n        break;\n\n      case 'reward':\n        m[key] = web3.utils.fromWei(m[key], 'ether') + 'META';\n        break;\n\n      case 'createdAt':\n        m[key] = timeConverter(m[key]);\n        break;\n\n      default:\n        if (!m[key]) m[key] = '';\n        break;\n    }\n  });\n  return m;\n}\n/**\n * \n * @param {*} key \n * @param {*} val \n * @returns {map} b: true if valid or false if invalid, err: error message\n */\n\n\nfunction validate(key, val) {\n  switch (key) {\n    case 'title':\n    case 'explanation':\n      if (!val) return {\n        b: false,\n        err: 'Please fill up something'\n      };\n      if (isValidLength(val) > 32) return {\n        b: false,\n        err: 'Only 32 bytes allowed'\n      };\n      return {\n        b: true\n      };\n\n    case 'reward':\n      if (val < 5) return {\n        b: false,\n        err: 'Reward should be greater than 5 META'\n      };\n      return {\n        b: true\n      };\n\n    case 'issuer':\n      if (!val || !web3.utils.isAddress(val)) return {\n        b: false,\n        err: 'Please fill up valid issuers'\n      };\n      return {\n        b: true\n      };\n\n    case 'topics':\n      if (!val || val.length === 0) return {\n        b: false,\n        err: 'Select at least 1 topic'\n      };else if (val.filter(function (e) {\n        return e.title === '';\n      }).length > 0) return {\n        b: false,\n        err: 'Select a topic'\n      };else if (val.filter(function (e) {\n        return e.issuer === '';\n      }).length > 0) return {\n        b: false,\n        err: 'Please fill up valid issuers'\n      };\n      return {\n        b: true\n      };\n\n    default:\n      return {\n        b: false,\n        err: 'Unknown'\n      };\n  }\n}\n\nvar encoder = new TextEncoder('utf-8');\n/**\n * Check if in 32 bytes or not\n * @param {*} str \n */\n\nfunction isValidLength(str) {\n  return encoder.encode(str).length;\n}\n/**\n * Serialize / Deserialize object at local storage\n */\n\n\nvar save = function save(key, obj) {\n  return window.localStorage.setItem(key, JSON.stringify(obj));\n};\n\nvar load = function load(key) {\n  return JSON.parse(window.localStorage.getItem(key));\n};\n\nvar getTopicsFromLocal = function getTopicsFromLocal() {\n  return load('topics');\n};\n\nvar getAchievementsFromLocal = function getAchievementsFromLocal() {\n  return load('achievements');\n};\n\nvar setTopicsToLocal = function setTopicsToLocal(obj) {\n  return save('topics', obj);\n};\n\nvar setAchievementsToLocal = function setAchievementsToLocal(obj) {\n  return save('achievements', obj);\n};\n\nexport { timeConverter, sleep, convertHexToString, asyncForEach, refine, isValidLength, validate, save, load, getTopicsFromLocal, getAchievementsFromLocal, setTopicsToLocal, setAchievementsToLocal };","map":{"version":3,"sources":["/Users/jeong-go-eun/Desktop/metagate/src/util.js"],"names":["web3","months","timeConverter","timestamp","a","Date","month","getMonth","getFullYear","getDate","convertHexToString","input","hex","toString","str","i","length","substr","String","fromCharCode","parseInt","sleep","ms","Promise","resolve","setTimeout","asyncForEach","array","callback","index","refine","m","Object","keys","forEach","key","isNaN","utils","fromWei","validate","val","b","err","isValidLength","isAddress","filter","e","title","issuer","encoder","TextEncoder","encode","save","obj","window","localStorage","setItem","JSON","stringify","load","parse","getItem","getTopicsFromLocal","getAchievementsFromLocal","setTopicsToLocal","setAchievementsToLocal"],"mappings":"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","sourcesContent":["import web3 from './ethereum/web3';\n\nvar months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\n\n/**\n * Convert UNIX timestamp to readable\n * @param {*} timestamp UNIX\n */\nfunction timeConverter(timestamp) {\n  var a = new Date(timestamp * 1000);\n  var month = months[a.getMonth()];\n  return a.getFullYear() + ' / ' + month + ' / ' + a.getDate();\n}\n\nfunction convertHexToString(input) {\n  var hex = input.toString();\n  var str = '';\n  for (var i = 0; (i < hex.length && hex.substr(i, 2) !== '00'); i += 2)\n    str += String.fromCharCode(parseInt(hex.substr(i, 2), 16));\n  return str;\n}\n\nfunction sleep(ms) {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n\nasync function asyncForEach(array, callback) {\n  for (let index = 0; index < array.length; index++) {\n    await callback(array[index], index, array);\n  }\n}\n\nfunction refine(m) {\n  if (! m) return null;\n  Object.keys(m).forEach(key => {\n    if (! isNaN(key)) return delete m[key];\n    switch (key) {\n      case 'title': m[key] = convertHexToString(m[key]); break;\n      case 'explanation': m[key] = convertHexToString(m[key]); break;\n      case 'reward': m[key] = web3.utils.fromWei(m[key], 'ether') + 'META'; break;\n      case 'createdAt': m[key] = timeConverter(m[key]); break;\n      default: if (! m[key]) m[key] = ''; break;\n    }\n  });\n  return m;\n}\n\n/**\n * \n * @param {*} key \n * @param {*} val \n * @returns {map} b: true if valid or false if invalid, err: error message\n */\nfunction validate(key, val) {\n  switch (key) {\n    case 'title':\n    case 'explanation':\n      if (! val) return { b: false, err: 'Please fill up something' }\n      if (isValidLength(val) > 32) return { b: false, err: 'Only 32 bytes allowed' }\n      return { b: true }\n    case 'reward':\n      if (val < 5) return { b: false, err: 'Reward should be greater than 5 META' }\n      return { b: true }\n    case 'issuer':\n      if (! val || ! web3.utils.isAddress(val)) return { b: false, err: 'Please fill up valid issuers' }\n      return { b: true }\n    case 'topics':\n      if (! val || val.length === 0) return { b: false, err: 'Select at least 1 topic' }\n      else if (val.filter(e => e.title === '').length > 0) return { b: false, err: 'Select a topic' }\n      else if (val.filter(e => e.issuer === '').length > 0) return { b: false, err: 'Please fill up valid issuers' }\n      return { b: true }\n    default: return { b: false, err: 'Unknown' }\n  }\n}\n\nvar encoder = new TextEncoder('utf-8');\n\n/**\n * Check if in 32 bytes or not\n * @param {*} str \n */\nfunction isValidLength(str) {\n  return encoder.encode(str).length;\n}\n\n/**\n * Serialize / Deserialize object at local storage\n */\nvar save = (key, obj) => window.localStorage.setItem(key, JSON.stringify(obj));\nvar load = (key) => JSON.parse(window.localStorage.getItem(key));\n\nvar getTopicsFromLocal = () => load('topics');\nvar getAchievementsFromLocal = () => load('achievements');\nvar setTopicsToLocal = (obj) => save('topics', obj);\nvar setAchievementsToLocal = (obj) => save('achievements', obj);\n\nexport {\n    timeConverter,\n    sleep,\n    convertHexToString,\n    asyncForEach,\n    refine,\n    isValidLength,\n    validate,\n    save,\n    load,\n    getTopicsFromLocal,\n    getAchievementsFromLocal,\n    setTopicsToLocal,\n    setAchievementsToLocal\n}"]},"metadata":{},"sourceType":"module"}